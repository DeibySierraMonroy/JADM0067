<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/Resource/template/mesaTemplate.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="content">
        <h:form id="form3">
            <p:card style="width:auto" >
                <div class="grid">
                    <div class="col-12 lg:col-12">
                        <div class="p-0 h-full">
                            <div class="shadow-2 p-3 h-full flex flex-column surface-card" style="border-radius: 6px
                                 ;border-top-style: solid;border-top-color:#006ba1">
                                <div class="card">
                                    <p:panelGrid columns="1"
                                                 layout="grid"
                                                 styleClass="showcase-text-align-center"
                                                 rendered="true"
                                                 id="visualizacionCan">
                                        <p:steps activeIndex="2" class="ui-steps-number">
                                            <p:menuitem value="Seleccion"/>
                                            <p:menuitem value="Visualizacion"/>
                                            <p:menuitem value="Aprobacion"/>
                                        </p:steps>
                                    </p:panelGrid>
                                </div>
                                <div class="field col-12 ">
                                    <div class="grid ui-fluid">
                                        <div class="col-4">
                                            <h5>Empresa :</h5>
                                            <div class="ui-inputgroup">
                                                <div class="ui-inputgroup-addon"><i class="pi pi-building"></i></div>
                                                <p:inputText 
                                                    readonly="true"
                                                    id="empresa"
                                                    value="#{acuerdoEmpresaBean.informacionAsociada.tdc_td}- #{acuerdoEmpresaBean.informacionAsociada.emp_nd}- #{acuerdoEmpresaBean.informacionAsociada.emp_nom}"
                                                    />
                                                <p:tooltip for="empresa"  showEffect="clip" hideEffect="fold" value="#{acuerdoEmpresaBean.informacionAsociada.tdc_td}- #{acuerdoEmpresaBean.informacionAsociada.emp_nd}- #{acuerdoEmpresaBean.informacionAsociada.emp_nom}" position="bottom"/>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <h5>Candidato:</h5>
                                            <div class="ui-inputgroup">
                                                <div class="ui-inputgroup-addon"><i class="pi pi-user"></i></div>
                                                <p:inputText 
                                                    readonly="true"
                                                    value="#{acuerdoEmpresaBean.informacionAsociada.nombre_empleado}"
                                                    id="nombreEmpleado"
                                                    />
                                                <p:tooltip for="nombreEmpleado" value="#{acuerdoEmpresaBean.informacionAsociada.nombre_empleado}" position="bottom" showEffect="clip" hideEffect="fold"/>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <h5>Cargo:</h5>
                                            <div class="ui-inputgroup">
                                                <div class="ui-inputgroup-addon"><i class="pi pi-id-card"></i></div>
                                                <p:inputText 
                                                    readonly="true"
                                                    id="cargoEmpleado"
                                                    value="#{acuerdoEmpresaBean.informacionAsociada.cargo_empleado}"/>
                                                <p:tooltip for="cargoEmpleado" value="#{acuerdoEmpresaBean.informacionAsociada.cargo_empleado}" position="bottom" showEffect="clip" hideEffect="fold"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 lg:col-12">
                                    <div class="card">
                                        <div class="grid ui-fluid">
                                            <div class="field col-12 md:col-12">
                                                <div class="shadow-2 p-2 flex flex-column surface-card" style="border-radius: 6px
                                                     ;border-top-style: solid;border-top-color:#f2a325 ; height: auto ; width: auto">
                                                    <p:tabView dynamic="true" cache="true" >
                                                        <!--                                                        <p:ajax event="tabChange" 
                                                                                                                        async="true"  
                                                                                                                        listener="#{acuerdoEmpresaBean.cargarAcuerdoEmpresa()}"/>-->
                                                        <p:tab title="Visualizador de Documentos"  >
                                                            <div class="grid">
                                                                <h:panelGroup rendered="#{not empty checkBean.documentos}" id="contenedorPrincipal">
                                                                    <div class="ui-g-5">
                                                                        <div class="p-2">
                                                                            <p:treeTable value="#{checkBean.documentos}"
                                                                                         emptyMessage="Sin resultados" 
                                                                                         size="small"
                                                                                         selectionMode="single"
                                                                                         rows="10" 
                                                                                         paginator="true" 
                                                                                         paginatorPosition="bottom"
                                                                                         selection="#{checkBean.documentoSelect}" 
                                                                                         var="doc" >
                                                                                <p:ajax event="select" 
                                                                                        update="form3:j_idt23:contenedorPrincipal" 
                                                                                        listener="#{checkBean.getFullDocumentUrl}"/>
                                                                                <p:column headerText="Documento">
                                                                                    <h:outputText value="#{doc.nombreDocumento}" id="documento"/>
                                                                                </p:column>

                                                                                <p:column headerText="Check" width="45">
                                                                                    <p:triStateCheckbox id="ajaxTriState" value="#{doc.ldoTemporalEstado}">
                                                                                        <p:ajax event="change" update="form3:j_idt23:contenedorPrincipal message"
                                                                                                listener="#{checkBean.actualizarEstadoDocumento(doc)}"
                                                                                                />
                                                                                    </p:triStateCheckbox>
                                                                                </p:column>
                                                                                <p:column headerText="Estado" width="110">
                                                                                    <h:outputText value="#{doc.dataErpAz.azdCodigoCli eq null?'Pendiente':'Cargado'}"
                                                                                                  styleClass="status-#{doc.dataErpAz.azdCodigoCli eq null?'warning':'success'}"/>
                                                                                </p:column>
                                                                            </p:treeTable>
                                                                            <div class="col-12">
                                                                                <h:panelGroup style="display:block; text-align:center">
                                                                                    <p:commandButton id="finalizarProceso"
                                                                                                     value="Guardar"
                                                                                                     styleClass="ui-button-warning"
                                                                                                     type="button"
                                                                                                     onclick="PF('cambioEstado').show()"
                                                                                                     icon="pi pi-save"
                                                                                                     update="message"
                                                                                                     />
                                                                                </h:panelGroup>
                                                                            </div>  
                                                                        </div>
                                                                    </div>
                                                                    <div class="ui-g-7" >
                                                                        <div class="p-2">
                                                                            <h:panelGroup rendered="#{checkBean.documentoSelect eq null
                                                                                                      or checkBean.documentoSelect.data.dataErpAz.azdCodigoCli eq null}">
                                                                                <div class="flex items-center justify-center"
                                                                                     style=" height: 800px">
                                                                                    <span class="font-semibold status-error">Archivo no disponible</span>
                                                                                </div>
                                                                            </h:panelGroup>
                                                                            <h:panelGroup
                                                                                rendered="#{!(checkBean.documentoSelect eq null) and !(checkBean.documentoSelect.data.dataErpAz.azdCodigoCli eq null)}">
                                                                                <div class="flex items-center justify-center"
                                                                                     style=" height: 800px">
                                                                                    <iframe id="documentViewer"
                                                                                            src="#{checkBean.documentUrl}" 
                                                                                            class="w-full h-full"></iframe>
                                                                                </div>
                                                                            </h:panelGroup>
                                                                        </div>
                                                                    </div>
                                                                </h:panelGroup>
                                                            </div>
                                                        </p:tab>
                                                        <p:tab title="Información del Cliente">

                                                            <div class="p-0 h-full">
                                                                <div class="shadow-2 p-3 h-full flex flex-column surface-card" style="border-radius: 6px
                                                                     ;border-top-style: solid;border-top-color:#006ba1">
                                                                    <p:divider align="center" >
                                                                        <i class="pi pi-building mr-2"/>
                                                                        <b>  <p:outputLabel value="Información General"
                                                                                            style="font-family: Activos"/></b>
                                                                    </p:divider>
                                                                    <p:outputLabel value="Tipo de operación : #{acuerdoEmpresaBean.empresa.EMP_TIPO_OPERACION}"
                                                                                   style="font-family: Activos ; font-weight: bold"/>
                                                                    <div class="formgrid grid  p-3">                                                                      
                                                                        <div class="field col-1">
                                                                            <label class="labelAcuerdo">Tipo</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.TDC_TD_FIL}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-2">
                                                                            <label class="labelAcuerdo">Documento</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_ND_FIL}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-1">
                                                                            <label class="labelAcuerdo">DV</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_DV}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-4">
                                                                            <label class="labelAcuerdo">Razón Social</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield"  readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_RAZON_SOCIAL}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-4">
                                                                            <label class="labelAcuerdo">Ciudad</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield"  readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_CIUDAD}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-2 ">
                                                                            <label class="labelAcuerdo">Codigo Cliente</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield"  readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_ACU_CODIGO}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-3">
                                                                            <label class="labelAcuerdo">Teléfonos</label>
                                                                            <input class="ui-inputfield"  readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_TELEFONOS} - #{mesaContratosBean.empresa.EMP_CELULAR}">                                                                        
                                                                            </input>

                                                                        </div>
                                                                        <div class="field col-7">
                                                                            <label class="labelAcuerdo">Actividad Económica </label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield" readonly="true"  value="#{acuerdoEmpresaBean.empresa.EMP_ACTIVIDAD_ECONOMICA}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-6">
                                                                            <label class="labelAcuerdo">Dirección</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_DIRECCION_PRINCIPAL}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                        <div class="field col-1 ">
                                                                            <label class="labelAcuerdo" >Pricipal</label>
                                                                            <br></br>
                                                                            <p:commandButton id="priEmpresa"  type="button"
                                                                                             icon="pi pi-building"/>
                                                                            <p:tooltip for="priEmpresa" 
                                                                                       value="Principal de la Empresa" 
                                                                                       showEffect="clip" hideEffect="fold" />
                                                                            <p:overlayPanel for="priEmpresa" dynamic="true" style="width:300px">
                                                                                <p:dataTable var="principal" 
                                                                                             rows="5" 
                                                                                             value="#{acuerdoEmpresaBean.empresaPrincipals}" 

                                                                                             >
                                                                                    <p:column headerText="Principal">
                                                                                        <h:outputText value="#{principal.EEMPRESA_PRINCIPAL}"/>
                                                                                    </p:column>

                                                                                </p:dataTable>
                                                                            </p:overlayPanel>
                                                                        </div>
                                                                        <div class="field col-5">
                                                                            <label class="labelAcuerdo">Email</label>
                                                                            <br></br>
                                                                            <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_EMAIL}">                                                                        
                                                                            </input>
                                                                        </div>
                                                                    </div>
                                                                    <p:divider style="border-top: 2px solid ; border-color:#f2a325 " align="center" ></p:divider>
                                                                    <div class="col-12">
                                                                        <div class="grid">
                                                                            <div class="col-9">
                                                                                <div class="grid">
                                                                                    <div class="col-4 ">
                                                                                        <label class="labelAcuerdo">Agrupación Empresarial</label> 
                                                                                    </div>
                                                                                    <div class="col-7">
                                                                                        <div class="grid">
                                                                                            <div class="col-3">
                                                                                                <input class="ui-inputfield" readonly="true" 
                                                                                                       value="#{acuerdoEmpresaBean.empresa.EMP_AGRUPA_EMPRESARIAL}">     
                                                                                                </input>
                                                                                            </div>  
                                                                                            <div class="col-9">
                                                                                                <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_RAZON_SOCIAL}">     
                                                                                                </input> 
                                                                                            </div>  
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="col-4 ">
                                                                                        <label class="labelAcuerdo">Actividad Económica</label> 
                                                                                    </div>
                                                                                    <div class="col-7" >
                                                                                        <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_ACTIVIDAD_ECONOMICA}">     
                                                                                        </input>
                                                                                    </div>
                                                                                    <div class="col-4">
                                                                                        <label class="labelAcuerdo">Representante Legal</label> 
                                                                                    </div>
                                                                                    <div class="col-7" >
                                                                                        <div class="grid">
                                                                                            <div class="col-4" >
                                                                                                <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_DOC_REPRESENTANTE_LEGAL}"> 
                                                                                                </input>
                                                                                            </div>
                                                                                            <div class="col-8" >
                                                                                                <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_REPRESENTANTE_LEGAL}">   
                                                                                                </input>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="col-4">
                                                                                        <label class="labelAcuerdo">Auditor RRHH:</label> 
                                                                                    </div>
                                                                                    <div class="col-7" >
                                                                                        <input class="ui-inputfield" readonly="readonly" value="#{acuerdoEmpresaBean.empresa.EMP_AUTORIDAD_RRHH}">
                                                                                        </input>
                                                                                    </div>
                                                                                    <div class="col-4">
                                                                                        <label class="labelAcuerdo">Medio de Consulta:</label> 
                                                                                    </div>
                                                                                    <div class="col-3" >
                                                                                        <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_MEDIO_CONSULTA}">     
                                                                                        </input>
                                                                                    </div>
                                                                                    <div class="col-2">
                                                                                        <label class="labelAcuerdo">Cod CIIU :</label> 
                                                                                    </div>
                                                                                    <div class="col-2" >
                                                                                        <input class="ui-inputfield" readonly="true" value="#{acuerdoEmpresaBean.empresa.EMP_CODIGO_CIU}">     
                                                                                        </input>
                                                                                    </div>
                                                                                    <div class="col-4">
                                                                                        <label class="labelAcuerdo">N. Matricula:</label> 
                                                                                    </div>
                                                                                    <div class="col-7" >
                                                                                        <input class="ui-inputfield" readonly="true"  value="#{acuerdoEmpresaBean.empresa.NUM_MATRICULA_MERCANTIL}">     
                                                                                        </input>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-3">
                                                                                <p:divider align="center" >
                                                                                    <i class="pi pi-clone mr-2"/>
                                                                                    <b>  <p:outputLabel value="Acciones"
                                                                                                        style="font-family: Activos"/></b>
                                                                                </p:divider>
                                                                                <div class="col-12">
                                                                                    <p:commandButton value="RIC" 
                                                                                                     type="button" 
                                                                                                     id="responsable" 
                                                                                                     style="background-color:#f2a325; border-color:#f2a325" 
                                                                                                     icon="pi pi-users"
                                                                                                     onclick="PF('responsableInterno').show()"
                                                                                                     />
                                                                                    <p:tooltip for="responsable" value="Responsable Interno del Cliente" showEffect="clip" hideEffect="fold" />
                                                                                </div>
                                                                                <br></br>
                                                                                <div class="col-12">
                                                                                    <p:commandButton value="SUC" 
                                                                                                     type="button" 
                                                                                                     icon="pi pi-building " 
                                                                                                     id="sucursales" 
                                                                                                     style="background-color:#ce353a; border-color:#ce353a" 
                                                                                                     onclick="PF('sucursalEmpresa').show()"/>
                                                                                    <p:tooltip for="sucursales" value="Sucursales Empresa" showEffect="clip" hideEffect="fold" />
                                                                                </div>
                                                                                <br></br>
                                                                                <div class="col-12">
                                                                                    <p:commandButton value="COTS" 
                                                                                                     type="button"
                                                                                                     id="contacto" 
                                                                                                     icon="pi pi-phone" 
                                                                                                     onclick="PF('contactoSucursal').show()"/>
                                                                                    <p:tooltip for="contacto" value="Contacto Sucursal" showEffect="clip" hideEffect="fold" />
                                                                                </div>
                                                                            </div>
                                                                        </div> 
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </p:tab>
                                                        <p:tab title="Agrupaciones ">
                                                            <div class="grid" >
                                                                <div class="col-12 md:col-6 lg:col-12">
                                                                    <div class="shadow-2 p-2 flex flex-column surface-card" style="border-radius: 6px
                                                                         ;border-top-style: solid;border-top-color:#ce353a ; height: auto ; width: auto">
                                                                        <p:divider align="center" >
                                                                            <i class="pi  pi-clone mr-2"/>
                                                                            <b>  <p:outputLabel value="Acciones"
                                                                                                style="font-family: Activos"/></b>
                                                                        </p:divider>
                                                                        <div class="grid">
                                                                            <div class="col-12 md:col-4 lg:col-4">
                                                                                <p:commandButton value="Responsables" 
                                                                                                 type="button" 
                                                                                                 icon="pi pi-users " 
                                                                                                 id="responsableAgrupacion" 
                                                                                                 style="background-color:#ffffff; border:2px solid #ce353a ; color: #020202" 
                                                                                                 onclick="PF('responsableEmpresa').show()"/>
                                                                                <p:tooltip for="responsableAgrupacion" value="Clic para ver los responsables" showEffect="clip" hideEffect="fold"  position="bottom"/> 
                                                                            </div>
                                                                            <div class="col-12 md:col-4 lg:col-4">
                                                                                <p:commandButton value="Observaciones Generales" 
                                                                                                 type="button" 
                                                                                                 icon="pi pi-bookmark " 
                                                                                                 id="observacionesGenerales" 
                                                                                                 style="background-color:#ffffff; border:2px solid #2196F3 ; color: #020202" 
                                                                                                 onclick="PF('observacionesGenerales').show()"/>
                                                                                <p:tooltip for="observacionesGenerales" value="Clic para ver las observaciones Generales" showEffect="clip" hideEffect="fold"  position="bottom"/> 
                                                                            </div>
                                                                            <div class="col-12 md:col-4 lg:col-4">
                                                                                <p:commandButton value="Contacto Responsable" 
                                                                                                 type="button" 
                                                                                                 icon="pi pi-envelope " 
                                                                                                 id="contactoResponsable"
                                                                                                 style="background-color:#ffffff; border:2px solid #fbc02d ; color: #020202" 
                                                                                                 onclick="PF('contactoResponsable').show()"/>
                                                                                <p:tooltip for="contactoResponsable" value="Clic para ver el contacto responsable" showEffect="clip" hideEffect="fold"  position="bottom"/> 
                                                                            </div>
                                                                        </div>
                                                                        <p:divider align="center" >
                                                                            <i class="pi pi-folder mr-2"/>
                                                                            <b>  <p:outputLabel value="Acuerdos"
                                                                                                style="font-family: Activos"/></b>
                                                                        </p:divider>
                                                                        <div class="grid">
                                                                            <div class="col-12 md:col-1 lg:col-1">
                                                                                <p:inputText 
                                                                                    value="#{acuerdoEmpresaBean.agrupacion.AGA_CODIGO}" 
                                                                                    id="label"
                                                                                    readonly="true"
                                                                                    />
                                                                            </div>
                                                                            <div class="col-12 md:col-6 lg:col-8">
                                                                                <p:selectOneMenu value="#{acuerdoEmpresaBean.agrupacion}" 
                                                                                                 converter="entityConverter"    
                                                                                                 id="selectAgrupacionEmpresa"
                                                                                                 filter="true" 
                                                                                                 filterMatchMode="contains"
                                                                                                 >
                                                                                    <f:selectItem itemLabel="Seleccione una agrupación" itemValue="#{acuerdoEmpresaBean.agrupacion}" 
                                                                                                  noSelectionOption="true"/>
                                                                                    <f:selectItems value="#{acuerdoEmpresaBean.agrupacionEmpresas}" 
                                                                                                   var="agrupacion"
                                                                                                   itemLabel="#{agrupacion.AGA_DESCRIPCION}" 
                                                                                                   itemValue="#{agrupacion}"/>
                                                                                    <p:ajax event="change" listener="#{acuerdoEmpresaBean.agrupacionSeleccionada()}"
                                                                                            update="form3:j_idt23:label 
                                                                                            form3:j_idt23:tblAgrupacionSeleccionada
                                                                                            form3:j_idt23:observacionAgrupacion
                                                                                            form3:j_idt23:tblatriAgrupac 
                                                                                            form3:j_idt23:observacionAtributo
                                                                                            tblnotaEmpresa
                                                                                            tblresponsabl"
                                                                                            />
                                                                                    <f:facet name="footer">
                                                                                        <p:divider styleClass="mt-0"/>
                                                                                        <h:outputText value="#{acuerdoEmpresaBean.agrupacionEmpresas.size()}" style="font-weight:bold;"/>
                                                                                    </f:facet>
                                                                                </p:selectOneMenu>
                                                                            </div>
                                                                            <div class="col-12 md:col-2 lg:col-2">
                                                                                <p:commandButton value="NOTA" 
                                                                                                 type="button" 
                                                                                                 icon="pi pi-check-square" 
                                                                                                 id="notaAgrupacion" 
                                                                                                 style="background-color:#ce353a; border-color:#ce353a" 
                                                                                                 onclick="PF('notaEmpresa').show()"/>
                                                                                <p:tooltip for="notaAgrupacion" value="Clic para ver Nota" showEffect="clip" hideEffect="fold"  position="bottom"/>
                                                                            </div>
                                                                            <div class="col-12 md:col-6 lg:col-6">
                                                                                <p:divider align="center" >
                                                                                    <i class="pi pi-book mr-2"/>
                                                                                    <b>  <p:outputLabel value="Acuerdos por Agrupacion"
                                                                                                        style="font-family: Activos"/></b>
                                                                                </p:divider>
                                                                                <h5>Observacion :</h5>
                                                                                <p:inputText 
                                                                                    value="#{acuerdoEmpresaBean.acuerdoPorAgrupacion.ACC_OBSERVACION}" 
                                                                                    id="observacionAgrupacion"
                                                                                    readonly="true"
                                                                                    />
                                                                                <p:tooltip for="observacionAgrupacion" 
                                                                                           value="#{acuerdoEmpresaBean.acuerdoPorAgrupacion.ACC_OBSERVACION}" 
                                                                                           position="bottom"
                                                                                           showEffect="clip" 
                                                                                           hideEffect="fold"/>
                                                                                <br></br>
                                                                                <br></br>
                                                                                <p:dataTable var="agrupa" 
                                                                                             value="#{acuerdoEmpresaBean.acuerdoPorAgrupacions}"
                                                                                             draggableColumns="true"
                                                                                             id="tblAgrupacionSeleccionada"
                                                                                             reflow="true" 
                                                                                             scrollable="true"
                                                                                             scrollHeight="250"
                                                                                             selectionMode="single" 
                                                                                             selection="#{acuerdoEmpresaBean.acuerdoPorAgrupacion}"
                                                                                             rowKey="#{agrupa.ACC_CODIGO}"
                                                                                             >
                                                                                    <p:ajax event="rowSelect" 
                                                                                            listener="#{acuerdoEmpresaBean.agrupacionAtributoSeleccionado(event)}"
                                                                                            update="
                                                                                            form3:j_idt23:observacionAgrupacion 
                                                                                            form3:j_idt23:tblatriAgrupac 
                                                                                            form3:j_idt23:observacionAtributo"/>
                                                                                    <p:column headerText="Codigo">
                                                                                        <h:outputText value="#{agrupa.ACC_CODIGO}" />
                                                                                    </p:column>
                                                                                    <p:column headerText="Atributo">
                                                                                        <h:outputText value="#{agrupa.ATR_NOMBRE}" />
                                                                                    </p:column>
                                                                                    <p:column headerText="Tipo">
                                                                                        <h:outputText value="#{agrupa.ACC_TIPO_DETALLE}" />
                                                                                    </p:column>
                                                                                    <p:scrollTop target="parent" threshold="100" styleClass="custom-scrolltop" icon="pi pi-arrow-up" />
                                                                                </p:dataTable>
                                                                            </div>
                                                                            <div class="col-12 md:col-1 lg:col-1">
                                                                                <p:divider layout="vertical">
                                                                                    <i class="pi pi-map mr-2"/>
                                                                                </p:divider>
                                                                            </div>
                                                                            <div class="col-12 md:col-5 lg:col-5">
                                                                                <p:divider align="center" >
                                                                                    <i class="pi pi-file-o mr-2"/>
                                                                                    <b>  <p:outputLabel value="Atributos"
                                                                                                        style="font-family: Activos"/></b>
                                                                                </p:divider>
                                                                                <h5>Valor Atributo :</h5>
                                                                                <p:inputText 
                                                                                    value="#{acuerdoEmpresaBean.acuerdoPorAgrupacion.ACC_VALOR_ATRIBUTO}" 
                                                                                    id="observacionAtributo"
                                                                                    readonly="true"
                                                                                    />
                                                                                <p:tooltip for="observacionAtributo" 
                                                                                           value="#{acuerdoEmpresaBean.acuerdoPorAgrupacion.ACC_VALOR_ATRIBUTO}" 
                                                                                           position="bottom"
                                                                                           showEffect="clip" 
                                                                                           hideEffect="fold"/>
                                                                                <br></br>
                                                                                <br></br>
                                                                                <p:dataTable var="atriAgrupac" 
                                                                                             value="#{acuerdoEmpresaBean.agrupacionAtributos}"
                                                                                             draggableColumns="true"
                                                                                             id="tblatriAgrupac"
                                                                                             reflow="true" 
                                                                                             rows="5" 
                                                                                             >
                                                                                    <p:column headerText="Codigo">
                                                                                        <h:outputText value="#{atriAgrupac.DAC_CODIGO}" />
                                                                                    </p:column>
                                                                                    <p:column headerText="Observación">
                                                                                        <h:outputText value="#{atriAgrupac.ATR_NOMBRE_DETALLE}" />
                                                                                    </p:column>
                                                                                    <p:column headerText="Atributo Detalle">
                                                                                        <h:outputText value="#{atriAgrupac.DAC_DETALLE_DESCRIPCION}" />
                                                                                    </p:column>
                                                                                    <p:column headerText="Valor Detalle">
                                                                                        <h:outputText value="#{atriAgrupac.DAC_VALOR_ATR_DETALLE}" />
                                                                                    </p:column>
                                                                                </p:dataTable>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </p:tab>
                                                    </p:tabView>
                                                </div>
                                            </div>
                                        </div>    
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </p:card>
        </h:form>
        <h:form id="ventanaFinalizarProceso">
            <p:dialog header="Finalizar el Proceso" 
                      widgetVar="cambioEstado" 
                      minHeight="40" 
                      width="auto" 
                      showEffect="fade" 
                      modal="true">
                <div class="card">
                    <div class="ui-fluid formgrid grid">
                        <div class="field col-12 md:col-12">
                            <h5>Estado Seleccionado :</h5>
                            <p:selectOneMenu id="estado" 
                                             value="#{mesaContratosBean.estado}"
                                             filter="true" 
                                             filterMatchMode="contains"
                                             >

                                <f:selectItem itemLabel="AMC" itemValue="AMC"/>
                                <f:selectItem itemLabel="NAM" itemValue="NAM"/>
                                <p:ajax event="change" listener="#{mesaContratosBean.cambiarEstadoFinal}"  
                                        update="
                                        ventanaFinalizarProceso:selectCausal ventanaFinalizarProceso:textArea
                                        ventanaFinalizarProceso:panelSelectCausal
                                        "
                                        />
                                <br></br>
                            </p:selectOneMenu>   
                            <p:outputPanel id="panelSelectCausal" rendered="true" >
                                <p:selectOneMenu id="selectCausal" 
                                                 rendered="#{mesaContratosBean.opcionesNoAprobado}"
                                                 value="#{mesaContratosBean.causa}"
                                                 converter="entityConverter" 
                                                 filter="true" 
                                                 filterMatchMode="contains"
                                                 required="true"
                                                 requiredMessage="Es necesario que seleccione la causal de rechazo"
                                                 >
                                    <p:ajax event="change" listener="#{mesaContratosBean.cambiarEstadoFinal()}" />
                                    <f:selectItem value="#{null}"
                                                  itemLabel="Seleccione una causal"
                                                  />
                                    <f:selectItems value="#{mesaContratosBean.causalesList}" 
                                                   var="tipo"
                                                   itemLabel="#{tipo.descripcion_causal}" 
                                                   itemValue="#{tipo}"/>                                               
                                    <p:ajax event="change"                                            
                                            listener="#{mesaContratosBean.seleccionarCausal()}" update="ventanaFinalizarProceso:textArea "/>
                                    <br></br>
                                </p:selectOneMenu>  

                            </p:outputPanel>
                            <p:inputTextarea id="textArea"
                                             rows="6" 
                                             cols="33" 
                                             value="#{mesaContratosBean.observacionFinal}"
                                             />
                        </div>
                    </div>
                </div>
                <f:facet name="footer">
                    <p:commandButton value="No" 
                                     icon="pi pi-times"
                                     styleClass="ui-confirmdialog-no ui-button-flat"
                                     onclick="PF('cambioEstado').hide()"
                                     update="message"
                                     />
                    <p:commandButton value="Aceptar"
                                     action="#{mesaContratosBean.enviarCandidatoFirmar()}"
                                     styleClass="mr-2"                                   
                                     icon="pi pi-check" 
                                     onstart="PrimeFaces.monitorDownload(start);"
                                     oncomplete="PrimeFaces.monitorDownload(stop);" 
                                     timeout="2000"
                                     update="ventanaFinalizarProceso message "
                                     id="btnAceptar" 
                                     >                    
                    </p:commandButton>
                </f:facet>
            </p:dialog>
        </h:form>
        <p:outputPanel>
            <h:form id="seguimientoMesaContratos">
                <p:dialog header="Seguimiento Mesa Contratos" 
                          widgetVar="seguimientoMesa" 
                          minHeight="40" 
                          width="auto" 
                          showEffect="fade" 
                          modal="true">
                    <div class="card">
                        <div class="ui-fluid formgrid grid">
                            <p:dataTable var="sucursal" 
                                         value="#{acuerdoEmpresaBean.sucursal}"
                                         draggableColumns="true"
                                         id="tblSeguimientoMesa"
                                         reflow="true" 
                                         rows="6" 
                                         paginator="true"
                                         >
                                <p:column headerText="id ">
                                    <h:outputText value="#{sucursal.SUE_CODIGO}" />
                                </p:column>
                                <p:column headerText="Nombre">
                                    <h:outputText value="#{sucursal.SUE_NOMBRE}" />
                                </p:column>
                                <p:column headerText="Direccion">
                                    <h:outputText value="#{sucursal.SUE_DIRECCION}" />
                                </p:column>
                            </p:dataTable>
                        </div>
                    </div>
                </p:dialog>
            </h:form>
        </p:outputPanel>
    </ui:define>
</ui:composition>
